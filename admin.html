<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุชุญูู ุงููุชุฌุฑ | ูุฌูุจ ุงูุนุจุงุจ</title>
    
    <!-- ุดุงุดุฉ ุชุญููู ุจุณูุทุฉ -->
    <style>
        #loading-screen {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: white;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }
        
        #loading-screen i {
            font-size: 3rem;
            color: #2d5af1;
            margin-bottom: 20px;
        }
    </style>
    
    <!-- ุงูุฑูุงุจุท -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="admin-style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <!-- ุดุงุดุฉ ุงูุชุญููู -->
    <div id="loading-screen">
        <i class="fas fa-circle-notch fa-spin"></i>
        <p>ุฌุงุฑู ุชุญููู ููุญุฉ ุงูุชุญูู...</p>
    </div>

    <!-- ุดุฑูุท ุงูุชููู ุงูุนููู -->
    <nav class="admin-navbar" style="display:none;">
        <div class="admin-nav-container">
            <div class="admin-logo">
                <i class="fas fa-cogs"></i>
                <span>ููุญุฉ ุชุญูู ุงููุชุฌุฑ</span>
            </div>
            <div class="admin-user">
                <span class="user-name">ูุฌูุจ ุงูุนุจุงุจ</span>
                <div class="user-avatar">
                    <i class="fas fa-user-shield"></i>
                </div>
            </div>
        </div>
    </nav>

    <!-- ุฒุฑ ุงููุงุฆูุฉ ููููุงุชู -->
    <button class="sidebar-toggle" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
    <aside class="admin-sidebar">
        <div class="sidebar-header">
            <h3><i class="fas fa-bars"></i> ุงููุงุฆูุฉ</h3>
        </div>
        <ul class="sidebar-menu">
            <li class="active" data-tab="dashboard">
                <a href="#">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>ููุญุฉ ุงูุชุญูู</span>
                </a>
            </li>
            <li data-tab="products">
                <a href="#">
                    <i class="fas fa-box"></i>
                    <span>ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</span>
                </a>
            </li>
            <li data-tab="orders">
                <a href="#">
                    <i class="fas fa-shopping-cart"></i>
                    <span>ุงูุทูุจุงุช</span>
                    <span class="badge new-orders">5</span>
                </a>
            </li>
            <li data-tab="customers">
                <a href="#">
                    <i class="fas fa-users"></i>
                    <span>ุงูุนููุงุก</span>
                </a>
            </li>
            <li data-tab="analytics">
                <a href="#">
                    <i class="fas fa-chart-line"></i>
                    <span>ุงูุฅุญุตุงุฆูุงุช</span>
                </a>
            </li>
            <li data-tab="settings">
                <a href="#">
                    <i class="fas fa-cog"></i>
                    <span>ุงูุฅุนุฏุงุฏุงุช</span>
                </a>
            </li>
        </ul>
        <div class="sidebar-footer">
            <a href="index.html" class="btn-store">
                <i class="fas fa-store"></i>
                ุนุฑุถ ุงููุชุฌุฑ
            </a>
            <button class="btn-logout">
                <i class="fas fa-sign-out-alt"></i>
                ุชุณุฌูู ุฎุฑูุฌ
            </button>
        </div>
    </aside>

    <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
    <main class="admin-content">
        <!-- ููุญุฉ ุงูุชุญูู ุงูุฑุฆูุณูุฉ -->
        <section class="dashboard-content tab-content active" id="dashboard">
            <div class="content-header">
                <h1><i class="fas fa-tachometer-alt"></i> ููุญุฉ ุงูุชุญูู</h1>
                <p>ูุธุฑุฉ ุนุงูุฉ ุนูู ุฃุฏุงุก ุงููุชุฌุฑ</p>
            </div>
            
            <div class="stats-cards">
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #2d5af1;">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalOrders">0</h3>
                        <p>ุงูุทูุจุงุช ุงููููุฉ</p>
                    </div>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i> 12%
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #28a745;">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalRevenue">0 ุฑ.ุณ</h3>
                        <p>ุงูุฅูุฑุงุฏุงุช</p>
                    </div>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i> 8%
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #ff6b35;">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalCustomers">0</h3>
                        <p>ุงูุนููุงุก</p>
                    </div>
                    <div class="stat-trend up">
                        <i class="fas fa-arrow-up"></i> 5%
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon" style="background-color: #6f42c1;">
                        <i class="fas fa-box-open"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalProducts">0</h3>
                        <p>ุงูููุชุฌุงุช</p>
                    </div>
                    <div class="stat-trend down">
                        <i class="fas fa-arrow-down"></i> 2%
                    </div>
                </div>
            </div>
            
            <!-- ุงูุทูุจุงุช ุงูุฃุฎูุฑุฉ -->
            <div class="recent-orders">
                <h2><i class="fas fa-clock"></i> ุงูุทูุจุงุช ุงูุฃุฎูุฑุฉ</h2>
                <div class="table-container">
                    <table id="recentOrdersTable">
                        <thead>
                            <tr>
                                <th>ุฑูู ุงูุทูุจ</th>
                                <th>ุงูุนููู</th>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงููุจูุบ</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="recentOrdersBody">
                            <tr>
                                <td colspan="6" class="empty-table">ูุง ุชูุฌุฏ ุทูุจุงุช ุญุงููุงู</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช -->
        <section class="products-content tab-content" id="products">
            <div class="content-header">
                <h1><i class="fas fa-box"></i> ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" id="addProductBtn">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
                    </button>
                </div>
            </div>
            
            <!-- ููุชุฑ ุงูููุชุฌุงุช -->
            <div class="products-filter">
                <input type="text" id="productSearch" placeholder="ุงุจุญุซ ุนู ููุชุฌ...">
                <select id="categoryFilter">
                    <option value="all">ุฌููุน ุงููุฆุงุช</option>
                    <option value="ุฅููุชุฑูููุงุช">ุฅููุชุฑูููุงุช</option>
                    <option value="ุฅูุณุณูุงุฑุงุช">ุฅูุณุณูุงุฑุงุช</option>
                </select>
                <select id="statusFilter">
                    <option value="all">ุฌููุน ุงูุญุงูุงุช</option>
                    <option value="available">ูุชููุฑ</option>
                    <option value="unavailable">ุบูุฑ ูุชููุฑ</option>
                </select>
            </div>
            
            <!-- ุฌุฏูู ุงูููุชุฌุงุช -->
            <div class="table-container">
                <table id="productsTable">
                    <thead>
                        <tr>
                            <th>ุงูุตูุฑุฉ</th>
                            <th>ุงุณู ุงูููุชุฌ</th>
                            <th>ุงููุฆุฉ</th>
                            <th>ุงูุณุนุฑ</th>
                            <th>ุงููุฎุฒูู</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ุฅุฏุงุฑุฉ ุงูุทูุจุงุช -->
        <section class="orders-content tab-content" id="orders">
            <div class="content-header">
                <h1><i class="fas fa-shopping-cart"></i> ุฅุฏุงุฑุฉ ุงูุทูุจุงุช</h1>
                <div class="header-actions">
                    <select id="orderStatusFilter">
                        <option value="all">ุฌููุน ุงูุญุงูุงุช</option>
                        <option value="new">ุฌุฏูุฏ</option>
                        <option value="processing">ููุฏ ุงููุนุงูุฌุฉ</option>
                        <option value="shipped">ุชู ุงูุดุญู</option>
                        <option value="delivered">ุชู ุงูุชูุตูู</option>
                        <option value="cancelled">ููุบู</option>
                    </select>
                </div>
            </div>
            
            <!-- ุฌุฏูู ุงูุทูุจุงุช -->
            <div class="table-container">
                <table id="ordersTable">
                    <thead>
                        <tr>
                            <th>ุฑูู ุงูุทูุจ</th>
                            <th>ุงูุนููู</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ุงูููุชุฌุงุช</th>
                            <th>ุงููุจูุบ</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ุฅุฏุงุฑุฉ ุงูุนููุงุก -->
        <section class="customers-content tab-content" id="customers">
            <div class="content-header">
                <h1><i class="fas fa-users"></i> ุฅุฏุงุฑุฉ ุงูุนููุงุก</h1>
                <div class="header-actions">
                    <input type="text" id="customerSearch" placeholder="ุงุจุญุซ ุนู ุนููู...">
                </div>
            </div>
            
            <!-- ุฌุฏูู ุงูุนููุงุก -->
            <div class="table-container">
                <table id="customersTable">
                    <thead>
                        <tr>
                            <th>ุงูุงุณู</th>
                            <th>ุงููุงุชู</th>
                            <th>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                            <th>ุนุฏุฏ ุงูุทูุจุงุช</th>
                            <th>ุฅุฌูุงูู ุงููุดุชุฑูุงุช</th>
                            <th>ุชุงุฑูุฎ ุงูุชุณุฌูู</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="customersTableBody">
                        <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ุงูุฅุญุตุงุฆูุงุช -->
        <section class="analytics-content tab-content" id="analytics">
            <div class="content-header">
                <h1><i class="fas fa-chart-line"></i> ุงูุฅุญุตุงุฆูุงุช</h1>
                <div class="header-actions">
                    <select id="analyticsPeriod">
                        <option value="7days">ุขุฎุฑ 7 ุฃูุงู</option>
                        <option value="30days">ุขุฎุฑ 30 ููู</option>
                        <option value="90days">ุขุฎุฑ 90 ููู</option>
                        <option value="year">ูุฐู ุงูุณูุฉ</option>
                    </select>
                </div>
            </div>
            
            <!-- ูุฎุทุทุงุช ุงูุฅุญุตุงุฆูุงุช -->
            <div class="analytics-charts">
                <div class="chart-container">
                    <h3><i class="fas fa-chart-bar"></i> ุงูุทูุจุงุช ุงูููููุฉ</h3>
                    <canvas id="ordersChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3><i class="fas fa-chart-pie"></i> ุชูุฒูุน ุงููุจูุนุงุช ุญุณุจ ุงููุฆุฉ</h3>
                    <canvas id="salesChart"></canvas>
                </div>
            </div>
            
            <!-- ุฃูุถู ุงูููุชุฌุงุช -->
            <div class="top-products">
                <h3><i class="fas fa-trophy"></i> ุฃูุถู 5 ููุชุฌุงุช ูุจูุนุงู</h3>
                <div class="top-products-list" id="topProductsList">
                    <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                </div>
            </div>
        </section>

        <!-- ุงูุฅุนุฏุงุฏุงุช -->
        <section class="settings-content tab-content" id="settings">
            <div class="content-header">
                <h1><i class="fas fa-cog"></i> ุฅุนุฏุงุฏุงุช ุงููุชุฌุฑ</h1>
            </div>
            
            <!-- ุฅุนุฏุงุฏุงุช ุนุงูุฉ -->
            <div class="settings-section">
                <h3><i class="fas fa-store"></i> ูุนูููุงุช ุงููุชุฌุฑ</h3>
                <form id="storeSettingsForm">
                    <div class="form-group">
                        <label for="storeName">ุงุณู ุงููุชุฌุฑ</label>
                        <input type="text" id="storeName" value="ูุชุฌุฑ ุชููู">
                    </div>
                    <div class="form-group">
                        <label for="storeEmail">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" id="storeEmail" value="mjyblwan0@gmail.com">
                    </div>
                    <div class="form-group">
                        <label for="storePhone">ุฑูู ุงููุงุชู</label>
                        <input type="tel" id="storePhone" value="781238648">
                    </div>
                    <div class="form-group">
                        <label for="storeAddress">ุงูุนููุงู</label>
                        <textarea id="storeAddress" rows="3">ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ</textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> ุญูุธ ุงูุชุบููุฑุงุช
                    </button>
                </form>
            </div>
            
            <!-- ุฃููุงุฏ ุงูุฎุตู -->
            <div class="settings-section">
                <h3><i class="fas fa-tags"></i> ุฃููุงุฏ ุงูุฎุตู</h3>
                <div class="discount-codes">
                    <table>
                        <thead>
                            <tr>
                                <th>ุงูููุฏ</th>
                                <th>ูุณุจุฉ ุงูุฎุตู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody id="discountCodesTable">
                            <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                        </tbody>
                    </table>
                    <button class="btn btn-secondary" id="addDiscountCode">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ููุฏ ุฎุตู
                    </button>
                </div>
            </div>
        </section>
    </main>

    <!-- ูุงูุฐุฉ ุฅุถุงูุฉ/ุชุนุฏูู ููุชุฌ -->
    <div class="modal-overlay" id="productModal" style="display: none;">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="productModalTitle">ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="productId">
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productName">ุงุณู ุงูููุชุฌ *</label>
                            <input type="text" id="productName" required>
                        </div>
                        <div class="form-group">
                            <label for="productCategory">ุงููุฆุฉ *</label>
                            <select id="productCategory" required>
                                <option value="">ุงุฎุชุฑ ุงููุฆุฉ</option>
                                <option value="ุฅููุชุฑูููุงุช">ุฅููุชุฑูููุงุช</option>
                                <option value="ุฅูุณุณูุงุฑุงุช">ุฅูุณุณูุงุฑุงุช</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productPrice">ุงูุณุนุฑ (ุฑ.ุณ) *</label>
                            <input type="number" id="productPrice" min="0" step="0.01" required>
                        </div>
                        <div class="form-group">
                            <label for="productOldPrice">ุงูุณุนุฑ ุงููุฏูู (ุฑ.ุณ)</label>
                            <input type="number" id="productOldPrice" min="0" step="0.01">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="productDescription">ุงููุตู *</label>
                        <textarea id="productDescription" rows="3" required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productImage">ุฑุงุจุท ุงูุตูุฑุฉ</label>
                            <input type="text" id="productImage" placeholder="images/product.png">
                        </div>
                        <div class="form-group">
                            <label for="productStock">ุงููุฎุฒูู *</label>
                            <select id="productStock" required>
                                <option value="true">ูุชููุฑ</option>
                                <option value="false">ุบูุฑ ูุชููุฑ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="productFeatured">
                            <span>ููุชุฌ ูููุฒ</span>
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">ุฅูุบุงุก</button>
                <button class="btn btn-primary" id="saveProductBtn">ุญูุธ ุงูููุชุฌ</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุนุฑุถ ุชูุงุตูู ุงูุทูุจ -->
    <div class="modal-overlay" id="orderDetailsModal" style="display: none;">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 id="orderDetailsTitle">ุชูุงุตูู ุงูุทูุจ #</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="orderDetailsContent">
                    <!-- ุณูุชู ููุคูุง ุจู JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary close-modal">ุฅุบูุงู</button>
                <button class="btn btn-primary" id="updateOrderStatusBtn">ุชุญุฏูุซ ุงูุญุงูุฉ</button>
            </div>
        </div>
    </div>

    <!-- ุฑุจุท ูููุงุช JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
// ==================== ูุธุงู ููุญุฉ ุงูุชุญูู ุงููุงูู ====================
document.addEventListener('DOMContentLoaded', function() {
    console.log('๐ ุจุฏุก ุชุญููู ููุญุฉ ุงูุชุญูู...');
    
    // ุงูุชุญูู ูู ุชุณุฌูู ุงูุฏุฎูู
    if (!sessionStorage.getItem('admin_logged_in')) {
        console.log('โ ุบูุฑ ูุณุฌู ุฏุฎูู - ุชูุฌูู ุฅูู login.html');
        window.location.href = 'login.html';
        return;
    }
    
    console.log('โ ูุณุฌู ุฏุฎูู ุจูุฌุงุญ');
    
    // ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู ุจุนุฏ 1.5 ุซุงููุฉ
    setTimeout(function() {
        const loadingScreen = document.getElementById('loading-screen');
        if (loadingScreen) {
            loadingScreen.style.display = 'none';
            console.log('โ ุชู ุฅุฎูุงุก ุดุงุดุฉ ุงูุชุญููู');
        }
        
        // ุฅุธูุงุฑ ุดุฑูุท ุงูุชููู
        const navbar = document.querySelector('.admin-navbar');
        if (navbar) {
            navbar.style.display = 'flex';
        }
        
        // ุชุญููู ูุนุฑุถ ุงูุจูุงูุงุช
        loadAdminData();
        
        // ุชูุนูู ูุธุงู ุงูููุงุฆู
        setupAdminTabs();
        
        // ุฅุถุงูุฉ ุงูุฃุญุฏุงุซ ููุฃุฒุฑุงุฑ
        setupEventListeners();
    }, 1500);
});

// ==================== ุฏูุงู ููุญุฉ ุงูุชุญูู ====================

// ุฏุงูุฉ ุชุญููู ูุนุฑุถ ุงูุจูุงูุงุช
function loadAdminData() {
    console.log('๐ ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...');
    
    // 1. ุชุญููู ุงูููุชุฌุงุช ูู localStorage
    let products = JSON.parse(localStorage.getItem('products')) || [];
    
    // ุฅุฐุง ูู ุชูุฌุฏ ููุชุฌุงุชุ ุงุณุชุฎุฏู ุงูููุชุฌุงุช ุงูุงูุชุฑุงุถูุฉ
    if (products.length === 0) {
        console.log('โ๏ธ ูุง ุชูุฌุฏ ููุชุฌุงุช ูู localStorageุ ุงุณุชุฎุฏุงู ุงูููุชุฌุงุช ุงูุงูุชุฑุงุถูุฉ');
        products = getDefaultProducts();
        localStorage.setItem('products', JSON.stringify(products));
    }
    
    console.log(`๐ฆ ุนุฏุฏ ุงูููุชุฌุงุช: ${products.length}`);
    
    // ุนุฑุถ ุงูููุชุฌุงุช ูู ุงูุฌุฏูู
    displayProducts(products);
    
    // 2. ุชุญููู ุงูุทูุจุงุช ูู localStorage
    const orders = JSON.parse(localStorage.getItem('orders')) || [];
    console.log(`๐ฆ ุนุฏุฏ ุงูุทูุจุงุช: ${orders.length}`);
    
    // ุนุฑุถ ุงูุทูุจุงุช
    displayOrders(orders);
    
    // 3. ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
    updateAdminStats(products, orders);
    
    console.log('โ ุชู ุชุญููู ุฌููุน ุงูุจูุงูุงุช ุจูุฌุงุญ');
}

// ุฏุงูุฉ ุงูุญุตูู ุนูู ุงูููุชุฌุงุช ุงูุงูุชุฑุงุถูุฉ
function getDefaultProducts() {
    return [
        {
            "id": 1,
            "name": "ุณูุงุนุฉ ุฑุฃุณ ูุงุณูููุฉ",
            "category": "ุฅููุชุฑูููุงุช",
            "price": 250,
            "oldPrice": 300,
            "image": "images/headphones.png",
            "description": "ุณูุงุนุฉ ุฑุฃุณ ุนุงููุฉ ุงูุฌูุฏุฉ ูุน ุฅูุบุงุก ุงูุถูุถุงุก ุงููุดุทุ ุจุทุงุฑูุฉ ุชุฏูู 30 ุณุงุนุฉ.",
            "inStock": true,
            "featured": true
        },
        {
            "id": 2,
            "name": "ูุงุชู ุฐูู",
            "category": "ุฅููุชุฑูููุงุช",
            "price": 1200,
            "oldPrice": 1400,
            "image": "images/phone.png",
            "description": "ุฃุญุฏุซ ูุงุชู ุฐูู ุจูุงููุฑุง ุฑุจุงุนูุฉุ ุดุงุดุฉ 6.7 ุจูุตุฉุ ุฐุงูุฑุฉ 128 ุฌูุฌุงุจุงูุช.",
            "inStock": true,
            "featured": true
        },
        {
            "id": 3,
            "name": "ุณุงุนุฉ ุฐููุฉ",
            "category": "ุฅููุชุฑูููุงุช",
            "price": 180,
            "oldPrice": 220,
            "image": "images/smartwatch.png",
            "description": "ุณุงุนุฉ ุฐููุฉ ุชุชุจุน ุงูููุงูุฉุ ูุนุฏู ุถุฑุจุงุช ุงูููุจุ ุงููููุ ููุงููุฉ ูููุงุก.",
            "inStock": true,
            "featured": false
        },
        {
            "id": 4,
            "name": "ููุญุฉ ููุงุชูุญ ูููุงููููุฉ",
            "category": "ุฅููุชุฑูููุงุช",
            "price": 90,
            "oldPrice": 120,
            "image": "images/keyboard.png",
            "description": "ููุญุฉ ููุงุชูุญ ูููุงููููุฉ ุจุฅุถุงุกุฉ RGBุ ููุงุชูุญ ุญูุฑุงุกุ ุชูุตูู USB.",
            "inStock": true,
            "featured": true
        },
        {
            "id": 5,
            "name": "ูุงูุณ ุฃูุนุงุจ",
            "category": "ุฅูุณุณูุงุฑุงุช",
            "price": 45,
            "oldPrice": 60,
            "image": "images/mouse.png",
            "description": "ูุงูุณ ุฃูุนุงุจ ุจุฏูุฉ 16000 ููุทุฉ ูู ุงูุจูุตุฉุ 8 ุฃุฒุฑุงุฑ ูุงุจูุฉ ููุจุฑูุฌุฉ.",
            "inStock": true,
            "featured": false
        },
        {
            "id": 6,
            "name": "ุญููุจุฉ ููุจููุชุฑ ูุญููู",
            "category": "ุฅูุณุณูุงุฑุงุช",
            "price": 35,
            "oldPrice": 50,
            "image": "images/laptop-bag.png",
            "description": "ุญููุจุฉ ููุจููุชุฑ ูุญููู ููุงููุฉ ูููุงุกุ ุฌููุจ ูุชุนุฏุฏุฉุ ุดุงุญู ูุญููู.",
            "inStock": false,
            "featured": false
        }
    ];
}

// ุฏุงูุฉ ุนุฑุถ ุงูููุชุฌุงุช ูู ุงูุฌุฏูู
function displayProducts(products) {
    const productsBody = document.getElementById('productsTableBody');
    if (!productsBody) return;
    
    if (products.length === 0) {
        productsBody.innerHTML = `
            <tr>
                <td colspan="7" class="empty-table">
                    <i class="fas fa-box-open"></i>
                    ูุง ุชูุฌุฏ ููุชุฌุงุช
                </td>
            </tr>
        `;
        return;
    }
    
    productsBody.innerHTML = products.map(product => `
        <tr>
            <td>
                <img src="${product.image || 'images/default.png'}" 
                     class="product-image" 
                     alt="${product.name}"
                     style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"
                     onerror="this.onerror=null; this.src='https://via.placeholder.com/50x50/2d5af1/FFFFFF?text=${product.name.substring(0, 5)}'">
            </td>
            <td><strong>${product.name}</strong></td>
            <td>${product.category}</td>
            <td>${product.price} ุฑ.ุณ</td>
            <td>${product.inStock ? 'ูุนู' : 'ูุง'}</td>
            <td>
                <span class="status-badge ${product.inStock ? 'status-available' : 'status-unavailable'}" 
                      style="padding: 5px 10px; border-radius: 5px; display: inline-block; color: white; font-size: 0.8rem; background-color: ${product.inStock ? '#28a745' : '#dc3545'}">
                    ${product.inStock ? 'ูุชููุฑ' : 'ุบูุฑ ูุชููุฑ'}
                </span>
            </td>
            <td>
                <button class="btn-action btn-edit" onclick="editAdminProduct(${product.id})" style="width:35px;height:35px;border-radius:50%;border:none;background:#28a745;color:white;cursor:pointer;margin:2px;">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn-action btn-delete" onclick="deleteAdminProduct(${product.id})" style="width:35px;height:35px;border-radius:50%;border:none;background:#dc3545;color:white;margin:2px;cursor:pointer;">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        </tr>
    `).join('');
}

// ุฏุงูุฉ ุนุฑุถ ุงูุทูุจุงุช
function displayOrders(orders) {
    const ordersBody = document.getElementById('ordersTableBody');
    const recentOrdersBody = document.getElementById('recentOrdersBody');
    
    if (!ordersBody || !recentOrdersBody) return;
    
    if (orders.length === 0) {
        ordersBody.innerHTML = `
            <tr>
                <td colspan="7" class="empty-table">
                    <i class="fas fa-shopping-cart"></i>
                    ูุง ุชูุฌุฏ ุทูุจุงุช
                </td>
            </tr>
        `;
        
        recentOrdersBody.innerHTML = `
            <tr>
                <td colspan="6" class="empty-table">
                    <i class="fas fa-clock"></i>
                    ูุง ุชูุฌุฏ ุทูุจุงุช ุฃุฎูุฑุฉ
                </td>
            </tr>
        `;
        return;
    }
    
    // ุนุฑุถ ุงูุทูุจุงุช ุงููุงููุฉ
    ordersBody.innerHTML = orders.map(order => `
        <tr>
            <td>#${order.id.toString().slice(-6)}</td>
            <td>${order.customer?.name || 'ุบูุฑ ูุนุฑูู'}</td>
            <td>${order.date || 'ุบูุฑ ูุนุฑูู'}</td>
            <td>${order.cart?.length || 0} ููุชุฌ</td>
            <td>${order.total ? order.total.toFixed(2) : '0.00'} ุฑ.ุณ</td>
            <td>
                <span class="status-badge status-${order.status || 'new'}" 
                      style="padding: 5px 10px; border-radius: 5px; display: inline-block; color: white; font-size: 0.8rem; background-color: #2d5af1">
                    ${order.status || 'ุฌุฏูุฏ'}
                </span>
            </td>
            <td>
                <button class="btn-action btn-view" onclick="viewOrderDetails(${order.id})" style="width:35px;height:35px;border-radius:50%;border:none;background:#2d5af1;color:white;cursor:pointer;margin:2px;">
                    <i class="fas fa-eye"></i>
                </button>
            </td>
        </tr>
    `).join('');
    
    // ุนุฑุถ ุงูุทูุจุงุช ุงูุฃุฎูุฑุฉ (ุขุฎุฑ 5 ุทูุจุงุช)
    const recentOrders = orders.slice(-5).reverse();
    recentOrdersBody.innerHTML = recentOrders.map(order => `
        <tr>
            <td>#${order.id.toString().slice(-6)}</td>
            <td>${order.customer?.name || 'ุบูุฑ ูุนุฑูู'}</td>
            <td>${order.date || 'ุบูุฑ ูุนุฑูู'}</td>
            <td>${order.total ? order.total.toFixed(2) : '0.00'} ุฑ.ุณ</td>
            <td>
                <span class="status-badge" style="padding: 5px 10px; border-radius: 5px; display: inline-block; color: white; font-size: 0.8rem; background-color: #2d5af1">
                    ${order.status || 'ุฌุฏูุฏ'}
                </span>
            </td>
            <td>
                <button class="btn-action btn-view" onclick="viewOrderDetails(${order.id})" style="width:35px;height:35px;border-radius:50%;border:none;background:#2d5af1;color:white;cursor:pointer;margin:2px;">
                    <i class="fas fa-eye"></i>
                </button>
            </td>
        </tr>
    `).join('');
}

// ุฏุงูุฉ ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
function updateAdminStats(products, orders) {
    // ุชุญุฏูุซ ุนุฏุฏ ุงูููุชุฌุงุช
    const totalProductsEl = document.getElementById('totalProducts');
    if (totalProductsEl) totalProductsEl.textContent = products.length;
    
    // ุชุญุฏูุซ ุนุฏุฏ ุงูุทูุจุงุช
    const totalOrdersEl = document.getElementById('totalOrders');
    if (totalOrdersEl) totalOrdersEl.textContent = orders.length;
    
    // ุชุญุฏูุซ ุงูุฅูุฑุงุฏุงุช
    const totalRevenue = orders.reduce((sum, order) => sum + (order.total || 0), 0);
    const totalRevenueEl = document.getElementById('totalRevenue');
    if (totalRevenueEl) totalRevenueEl.textContent = totalRevenue.toFixed(2) + ' ุฑ.ุณ';
    
    // ุชุญุฏูุซ ุนุฏุฏ ุงูุนููุงุก
    const customersMap = new Map();
    orders.forEach(order => {
        if (order.customer && order.customer.phone) {
            customersMap.set(order.customer.phone, order.customer);
        }
    });
    const totalCustomersEl = document.getElementById('totalCustomers');
    if (totalCustomersEl) totalCustomersEl.textContent = customersMap.size;
    
    console.log(`๐ฐ ุงูุฅูุฑุงุฏุงุช: ${totalRevenue} ุฑ.ุณ`);
    console.log(`๐ฅ ุงูุนููุงุก: ${customersMap.size}`);
}

// ุฏุงูุฉ ุชูุนูู ูุธุงู ุงูุชุจููุจุงุช
function setupAdminTabs() {
    const menuItems = document.querySelectorAll('.sidebar-menu li');
    const tabContents = document.querySelectorAll('.tab-content');
    
    menuItems.forEach(item => {
        item.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');
            
            // ุฅุฒุงูุฉ ุงููุดุงุท ูู ุฌููุน ุงูุนูุงุตุฑ
            menuItems.forEach(i => i.classList.remove('active'));
            tabContents.forEach(tab => {
                tab.classList.remove('active');
                tab.style.display = 'none';
            });
            
            // ุฅุถุงูุฉ ุงููุดุงุท ููุนูุตุฑ ุงูุญุงูู
            this.classList.add('active');
            
            // ุฅุธูุงุฑ ุงููุญุชูู ุงููุญุฏุฏ
            const activeTab = document.getElementById(tabId);
            if (activeTab) {
                activeTab.classList.add('active');
                activeTab.style.display = 'block';
            }
            
            console.log(`๐ฏ ุชู ุชูุนูู ุงูุชุจููุจ: ${tabId}`);
        });
    });
    
    // ุชูุนูู ุงูุชุจููุจ ุงูุฃูู
    const firstTab = document.querySelector('.sidebar-menu li.active');
    if (firstTab) {
        firstTab.click();
    }
}

// ุฏูุงู ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช
function editAdminProduct(id) {
    console.log('โ๏ธ ุชุนุฏูู ุงูููุชุฌ:', id);
    
    // ุชุญููู ุงูููุชุฌุงุช
    const products = JSON.parse(localStorage.getItem('products')) || [];
    const product = products.find(p => p.id == id);
    
    if (!product) {
        alert('ุงูููุชุฌ ุบูุฑ ููุฌูุฏ');
        return;
    }
    
    // ููุก ุงููููุฐุฌ ุจููู ุงูููุชุฌ
    document.getElementById('productId').value = product.id;
    document.getElementById('productName').value = product.name;
    document.getElementById('productCategory').value = product.category;
    document.getElementById('productPrice').value = product.price;
    document.getElementById('productOldPrice').value = product.oldPrice || '';
    document.getElementById('productDescription').value = product.description;
    document.getElementById('productImage').value = product.image || '';
    document.getElementById('productStock').value = product.inStock.toString();
    document.getElementById('productFeatured').checked = product.featured || false;
    document.getElementById('productModalTitle').textContent = 'ุชุนุฏูู ุงูููุชุฌ';
    
    // ุฅุธูุงุฑ ุงููุงูุฐุฉ
    document.getElementById('productModal').style.display = 'flex';
}

function deleteAdminProduct(id) {
    if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูููุชุฌุ')) {
        console.log('๐๏ธ ุญุฐู ุงูููุชุฌ:', id);
        
        const products = JSON.parse(localStorage.getItem('products')) || [];
        const updatedProducts = products.filter(p => p.id != id);
        
        localStorage.setItem('products', JSON.stringify(updatedProducts));
        
        // ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
        loadAdminData();
        
        alert('โ ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ');
    }
}

// ุฏุงูุฉ ุนุฑุถ ุชูุงุตูู ุงูุทูุจ
function viewOrderDetails(id) {
    console.log('๐๏ธ ุนุฑุถ ุชูุงุตูู ุงูุทูุจ:', id);
    
    const orders = JSON.parse(localStorage.getItem('orders')) || [];
    const order = orders.find(o => o.id == id);
    
    if (!order) {
        alert('ุงูุทูุจ ุบูุฑ ููุฌูุฏ');
        return;
    }
    
    // ุนุฑุถ ุชูุงุตูู ุงูุทูุจ
    document.getElementById('orderDetailsTitle').textContent = `ุชูุงุตูู ุงูุทูุจ #${order.id.toString().slice(-6)}`;
    
    const orderDetailsContent = document.getElementById('orderDetailsContent');
    orderDetailsContent.innerHTML = `
        <div class="order-summary">
            <p><strong>ุฑูู ุงูุทูุจ:</strong> #${order.id.toString().slice(-6)}</p>
            <p><strong>ุงูุนููู:</strong> ${order.customer?.name || 'ุบูุฑ ูุนุฑูู'}</p>
            <p><strong>ุงููุงุชู:</strong> ${order.customer?.phone || 'ุบูุฑ ูุนุฑูู'}</p>
            <p><strong>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</strong> ${order.customer?.email || 'ุบูุฑ ูุนุฑูู'}</p>
            <p><strong>ุงูุนููุงู:</strong> ${order.customer?.address || 'ุบูุฑ ูุนุฑูู'}</p>
            <p><strong>ุงูุชุงุฑูุฎ:</strong> ${order.date || 'ุบูุฑ ูุนุฑูู'}</p>
            <p><strong>ุงูุญุงูุฉ:</strong> ${order.status || 'ุฌุฏูุฏ'}</p>
            <p><strong>ุงูุฅุฌูุงูู:</strong> ${order.total ? order.total.toFixed(2) : '0.00'} ุฑ.ุณ</p>
        </div>
        
        <h4>ุงูููุชุฌุงุช:</h4>
        <table style="width:100%; border-collapse: collapse; margin-top: 10px;">
            <thead>
                <tr style="background-color: #f8f9fa;">
                    <th style="padding: 10px; text-align: right;">ุงูููุชุฌ</th>
                    <th style="padding: 10px; text-align: right;">ุงูุณุนุฑ</th>
                    <th style="padding: 10px; text-align: right;">ุงููููุฉ</th>
                    <th style="padding: 10px; text-align: right;">ุงููุฌููุน</th>
                </tr>
            </thead>
            <tbody>
                ${(order.cart || []).map(item => `
                    <tr>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${item.name}</td>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${item.price} ุฑ.ุณ</td>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${item.quantity || 1}</td>
                        <td style="padding: 10px; border-bottom: 1px solid #eee;">${(item.price * (item.quantity || 1)).toFixed(2)} ุฑ.ุณ</td>
                    </tr>
                `).join('')}
            </tbody>
        </table>
    `;
    
    // ุฅุธูุงุฑ ุงููุงูุฐุฉ
    document.getElementById('orderDetailsModal').style.display = 'flex';
}

// ุฏุงูุฉ ุฅุนุฏุงุฏ ูุณุชูุนู ุงูุฃุญุฏุงุซ
function setupEventListeners() {
    // ุฒุฑ ุฅุบูุงู ุงูููุงูุฐ
    document.querySelectorAll('.close-modal').forEach(button => {
        button.addEventListener('click', function() {
            document.getElementById('productModal').style.display = 'none';
            document.getElementById('orderDetailsModal').style.display = 'none';
        });
    });
    
    // ุฒุฑ ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
    const addProductBtn = document.getElementById('addProductBtn');
    if (addProductBtn) {
        addProductBtn.addEventListener('click', function() {
            document.getElementById('productForm').reset();
            document.getElementById('productModalTitle').textContent = 'ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ';
            document.getElementById('productId').value = '';
            document.getElementById('productModal').style.display = 'flex';
        });
    }
    
    // ุฒุฑ ุญูุธ ุงูููุชุฌ
    const saveProductBtn = document.getElementById('saveProductBtn');
    if (saveProductBtn) {
        saveProductBtn.addEventListener('click', saveProduct);
    }
    
    // ุฒุฑ ุชุณุฌูู ุงูุฎุฑูุฌ
    const logoutBtn = document.querySelector('.btn-logout');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', function() {
            if (confirm('ูู ุชุฑูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ')) {
                sessionStorage.removeItem('admin_logged_in');
                window.location.href = 'login.html';
            }
        });
    }
    
    // ุฒุฑ ุงููุงุฆูุฉ ููููุงุชู
    const sidebarToggle = document.getElementById('sidebarToggle');
    if (sidebarToggle) {
        sidebarToggle.addEventListener('click', function() {
            const sidebar = document.querySelector('.admin-sidebar');
            if (sidebar) {
                sidebar.classList.toggle('active');
            }
        });
    }
    
    // ุฒุฑ ุงูุชุญุฏูุซ ููุทูุจุงุช
    const updateOrderBtn = document.getElementById('updateOrderStatusBtn');
    if (updateOrderBtn) {
        updateOrderBtn.addEventListener('click', function() {
            alert('ุณูุชู ุชูููุฐ ุชุญุฏูุซ ุญุงูุฉ ุงูุทูุจ ูู ุงูุฅุตุฏุงุฑ ุงููุงุฏู');
        });
    }
}

// ุฏุงูุฉ ุญูุธ ุงูููุชุฌ
function saveProduct() {
    const id = document.getElementById('productId').value;
    const name = document.getElementById('productName').value;
    const category = document.getElementById('productCategory').value;
    const price = parseFloat(document.getElementById('productPrice').value);
    const oldPrice = document.getElementById('productOldPrice').value ? parseFloat(document.getElementById('productOldPrice').value) : null;
    const description = document.getElementById('productDescription').value;
    const image = document.getElementById('productImage').value || 'images/default.png';
    const inStock = document.getElementById('productStock').value === 'true';
    const featured = document.getElementById('productFeatured').checked;
    
    // ุงูุชุญูู ูู ุงูุจูุงูุงุช
    if (!name || !category || !price || !description) {
        alert('ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุฌููุน ุงูุญููู ุงููุทููุจุฉ');
        return;
    }
    
    // ุชุญููู ุงูููุชุฌุงุช ุงูุญุงููุฉ
    let products = JSON.parse(localStorage.getItem('products')) || [];
    
    if (id) {
        // ุชุญุฏูุซ ููุชุฌ ููุฌูุฏ
        const index = products.findIndex(p => p.id == id);
        if (index !== -1) {
            products[index] = {
                ...products[index],
                name,
                category,
                price,
                oldPrice,
                description,
                image,
                inStock,
                featured
            };
        }
    } else {
        // ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
        const newId = products.length > 0 ? Math.max(...products.map(p => p.id)) + 1 : 1;
        products.push({
            id: newId,
            name,
            category,
            price,
            oldPrice,
            description,
            image,
            inStock,
            featured
        });
    }
    
    // ุญูุธ ูู localStorage
    localStorage.setItem('products', JSON.stringify(products));
    
    // ุฅุบูุงู ุงููุงูุฐุฉ ูุฅุนุงุฏุฉ ุงูุชุญููู
    document.getElementById('productModal').style.display = 'none';
    loadAdminData();
    
    alert(id ? 'โ ุชู ุชุญุฏูุซ ุงูููุชุฌ ุจูุฌุงุญ' : 'โ ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ');
}
    </script>
</body>
</html>
